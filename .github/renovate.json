{
    "labels": ["dependencies"],
    "ansible-galaxy": { "fileMatch": ["(^|/)(galaxy|requirements|ee-requirements)(\\.ansible)?\\.ya?ml$"] },
    "pre-commit": { "enabled": true },
    "packageRules": [
      {
        "matchManagers": ["dockerfile"],
        "matchPackagePatterns": ["ubi8"],
        "matchUpdateTypes": ["minor"],
        "automerge": true,
        "schedule": ["every weekend after 7am"]
      },
      {
        "matchManagers": ["github-actions"],
        "matchUpdateTypes": ["minor"],
        "automerge": true,
        "schedule": ["every weekend after 7am"]
      },
      {
        "matchPackagePatterns": ["rke2"],
        "labels": ["rke2"],
        "extractVersion": "^v(?<version>\\d+\\.\\d+.\\d+)"
      }
    ],
    "customManagers": [
      {
        "customType": "regex",
        "fileMatch": [
          "playbooks/vars/main\\.y[a]?ml$",
          "CHANGELOG.md",
          "README.md"
        ],
        "matchStrings": [
          "global_rke2_version: \"(?<currentValue>.*)\"\\n",
          "  - rke2 version: (?<currentValue>.*)\\n",
          "  - \\[RKE2 (?<currentValue>[^\\]]+)\\]\\(https://docs.rke2.io\\) - Security focused Kubernetes\\n"
        ],
        "depNameTemplate": "rke2",
        "versioningTemplate": "semver-coerced",
        "datasourceTemplate": "custom.rke2"
      },
      {
        "regexManagers": [
          {
            "fileMatch": ["^playbooks/vars/main\\.yaml$"],
            "matchStrings": ["global_helm_version: \"(?<currentValue>.*?)\"\\n"],
            "datasourceTemplate": "github-releases",
            "depNameTemplate": "helm/helm"
          }
        ]
      }
    ],
    "customDatasources": {
      "rke2": {
        "defaultRegistryUrlTemplate": "https://update.rke2.io/v1-release/channels",
        "transformTemplates": [
          "{\"releases\":[{\"version\": $$.(data[id = 'stable'].latest),\"sourceUrl\":\"https://github.com/rancher/rke2\",\"changelogUrl\":$join([\"https://github.com/rancher/rke2/releases/tag/\",data[id = 'stable'].latest])}],\"sourceUrl\": \"https://github.com/rancher/rke2\",\"homepage\": \"https://docs.rke2.io\"}"
        ]
      }
    }
}
