---
# Load kube-vip
- name: Find kube-vip images on the target server
  ansible.builtin.find:
    paths: "{{ mount_images_path }}/kubevip/"
    patterns: "*.tar"
  register: found_images

- name: Copy kube-vip images with skopeo
  ansible.builtin.command: "skopeo copy docker-archive:{{ item.path }} docker://localhost:5000/kube-vip/{{ item.path | basename | regex_replace('.tar', '') | regex_replace('_', ':') }} --dest-tls-verify=false"
  changed_when: false
  with_items: "{{ found_images['files'] }}"
